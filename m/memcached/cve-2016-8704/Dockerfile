FROM ubuntu:16.04
MAINTAINER xiao-xing <xiao_xing@hansight.com>

ADD sources.list /etc/apt/sources.list

RUN apt-get update
RUN apt-get install -y gcc make wget libevent-dev libc6-dev perl

WORKDIR /opt
RUN wget http://www.memcached.org/files/memcached-1.4.32.tar.gz \
    && tar zxvf memcached-1.4.32.tar.gz

WORKDIR /opt/memcached-1.4.32
RUN ./configure \
    && make \
    && make test \
    && make install

RUN groupadd -r memcache \
    && useradd -r -g memcache memcache

USER memcache

EXPOSE 11211

CMD ["./memcached", "-vv"]
